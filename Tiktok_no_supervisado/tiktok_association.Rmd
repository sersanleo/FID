---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code.

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*.

Instalaci칩n de librerias

```{r}
#install.packages("dplyr")
#install.packages("tidyverse")
#install.packages("caret")
library(readr)
library(dplyr)
library(tidyverse)
library(caret)

```

Lectura y carga de los datos del dataset

```{r}
tiktok <- read_csv("tiktok.csv")
head(tiktok)
```

Eliminaci칩n de elementos duplicados del dataset

```{r}
tiktok_unique = unique(tiktok)
summary(tiktok_unique)

```

Seleccionar columnas necesarias del dataset

```{r}
tiktok_data <- select(tiktok_unique,-"track_id",-"artist_name",-"album_id",-"playlist_id",-"playlist_name",-"duration_mins")
head(tiktok_data)
summary(tiktok_data)
```

Formateo de fechas - Se llama a la funci칩n changeDate mediante mutate para que cambie el string de la fecha si solo contiene el a침o de salida

```{r}

changeDate <- function(release_date){
  case_when(
    nchar(release_date)<10  ~ paste(release_date,"-01-01", sep=""),
    nchar(release_date)>=10  ~ release_date
  )
}
tiktok_data <- tiktok_data %>% mutate(release_date=changeDate(release_date))
tiktok_data


```

```{r}

tiktok_data <- tiktok_data %>% mutate(tempo=round(tempo, digits = 0))
tiktok_data$popularity = tiktok_data$popularity/100
tiktok_data
```

```{r}
process_tempo <- preProcess(as.data.frame(tiktok_data$tempo), method=c("range"))
norm_scale_tempo <- predict(process_tempo, as.data.frame(tiktok_data$tempo))
norm_scale_tempo

```

```{r}
process_acousticness <- preProcess(as.data.frame(tiktok_data$acousticness), method=c("range"))
norm_scale_acousticness <- predict(process_acousticness, as.data.frame(tiktok_data$acousticness))
norm_scale_acousticness
```

```{r}

process_loudness <- preProcess(as.data.frame(tiktok_data$loudness), method=c("range"))
norm_scale_loudness <- predict(process_loudness, as.data.frame(tiktok_data$loudness))
norm_scale_loudness

```

```{r}

process_instrumentalness <- preProcess(as.data.frame(tiktok_data$instrumentalness), method=c("range"))
norm_scale_instrumentalness <- predict(process_instrumentalness, as.data.frame(tiktok_data$instrumentalness))
norm_scale_instrumentalness

```

```{r}
tiktok_data$loudness <- norm_scale_loudness[,"tiktok_data$loudness"]
tiktok_data$acousticness <- norm_scale_acousticness[,"tiktok_data$acousticness"]
tiktok_data$tempo <- norm_scale_tempo[,"tiktok_data$tempo"]
tiktok_data
```
